library("readxl")
library(tidyverse)
library(reshape2)
library(caret)
gold_df<- read_excel("complete_data.xlsx")
head(gold_df)
summary(gold_df)
str(gold_df)
cols <- c("date", "sensex", "nifty", "snp", "oil_price", "usdinr", "interest_rate", "gold_demand", "snp_inr", "oil_price_inr", "gold_price")
colnames(gold_df) <- cols
gold_df$date <- as.character(gold_df$date)
sub_gold <- gold_df %>% select(-date)
cormat <- round(cor(sub_gold),2)
head(cormat)
melted_cormat <- melt(cormat)
head(melted_cormat)
ggplot(data = melted_cormat, aes(x=Var1, y=Var2, fill=value)) +
geom_tile()
mylog <- lm(gold_df$gold_price ~ gold_df$sensex + gold_df$nifty + gold_df$usdinr + gold_df$interest_rate + gold_df$gold_demand + gold_df$snp_inr + gold_df$oil_price_inr)
summary(mylog)
plot(mylog)
samples <- gold_df$gold_price %>% createDataPartition(p=0.8, list = FALSE)
train.data <- gold_df[samples,]
test.data <- gold_df[-samples,]
colnames(gold_df)
model <- lm(gold_price ~ sensex + nifty + usdinr+ interest_rate+ gold_demand+ snp_inr+ oil_price_inr+ gold_price ,data= train.data)
summary(model)
predictions <- model %>% predict(test.data)
RMSE(predictions, test.data$gold_price)
R2(predictions, test.data$gold_price)
my_preds <- data.frame(test.data$date, predictions)
(my_preds)
mylog_1 <- lm(gold_df$gold_price ~ gold_df$sensex + gold_df$nifty + gold_df$usdinr + gold_df$interest_rate + gold_df$gold_demand)
summary(mylog_1)
plot(mylog_1)
mylog_2 <- lm(gold_df$gold_price ~ gold_df$oil_price_inr + gold_df$snp_inr)
summary(mylog_2)
mylog_3 <- lm(gold_df$gold_price ~ gold_df$sensex + gold_df$nifty + gold_df$usdinr + gold_df$interest_rate + gold_df$snp_inr + gold_df$oil_price_inr)
summary(mylog_3)
mylog_4 <- lm(gold_df$gold_price ~ gold_df$usdinr + gold_df$interest_rate + gold_df$gold_demand + gold_df$snp_inr + gold_df$oil_price_inr)
summary(mylog_4)
mylogPossitive <- lm(gold_df$gold_price ~ gold_df$sensex + gold_df$nifty + gold_df$usdinr + gold_df$interest_rate + gold_df$snp_inr )
summary(mylogPossitive)
mylogNegative <- lm(gold_df$gold_price ~  gold_df$gold_demand + gold_df$oil_price_inr)
mylogNegative
summary(mylogNegative)
